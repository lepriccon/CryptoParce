<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypto Parce</title>
    <style>
        body {
            margin: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background: linear-gradient(to bottom, #2c2c2c, #000);
            overflow: hidden;
            color: white;
            font-family: Arial, sans-serif;
        }

        .price-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            max-width: 400px;
        }

        #price-list {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }

        #price-list li {
            margin: 10px;
            font-size: 18px;
            cursor: pointer;
        }

        #price-list li:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        #search-input {
            margin-bottom: 20px;
            padding: 10px;
            font-size: 18px;
            border: none;
            border-radius: 5px;
            width: 100%;
        }
    </style>
</head>
<body>
    <div class="price-container">
        <input type="text" id="search-input" placeholder="Search pair..." oninput="handleSearch()">
        <ul id="price-list"></ul>
    </div>

    <script>
      let currentPair = "";

      async function fetchPrice(pair) {
        const response = await fetch(`/prices?pair=${pair}`);
        const data = await response.json();

        if (data.price) {
          return { symbol: pair, price: data.price };
        } else {
          return null;
        }
      }

      async function updatePrice(pair) {
        const priceData = await fetchPrice(pair);

        if (priceData) {
          const list = document.getElementById("price-list");
          const existing = document.getElementById(pair);

          if (existing) {
            existing.textContent = `${pair}: ${priceData.price} USDT`;
          } else {
            const li = document.createElement("li");
            li.id = pair;
            li.textContent = `${pair}: ${priceData.price} USDT`;
            list.appendChild(li);
          }
        }
      }

      setInterval(() => {
        if (currentPair) {
          updatePrice(currentPair);
        }
      }, 1000);

      function handleSearch() {
        const input = document.getElementById("search-input").value.toUpperCase();

        const pairs = ["BTCUSDT", "ETHUSDT", "BNBUSDT", "LTCUSDT", "XRPUSDT"];

        const filteredPairs = pairs.filter(pair => pair.startsWith(input));

        const list = document.getElementById("price-list");
        list.innerHTML = "";

        filteredPairs.forEach(pair => {
          const li = document.createElement("li");
          li.textContent = pair;
          li.onclick = () => {
            currentPair = pair;
            updatePrice(pair);
            document.getElementById("search-input").value = pair;  // Устанавливаем значение в поле поиска
            list.innerHTML = "";  // Очищаем список подсказок
          };
          list.appendChild(li);
        });
      }
    </script>
</body>
</html>
